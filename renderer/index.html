<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#ffffff" />
    <title>Terraform UI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Mono:wght@400;500;600&display=swap" rel="stylesheet" />
    <!-- Load HLJS theme first so our stylesheet can override token colors -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css" />
    <!-- Our app styles last (override HLJS colors) -->
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="app-header">
      <div class="brand">Terraform UI</div>
      <div class="workspace">
        <button id="btn-open-workspace" title="Open Terraform workspace">Open</button>
        <span id="workspace-path" class="workspace-path" title="Current workspace path">No workspace selected</span>
        <label for="tf-workspace-select" class="muted" title="Terraform workspace">WS</label>
        <select id="tf-workspace-select" title="Select Terraform workspace"></select>
        <details id="tfvars-box" class="tfvars-box" title="Select *.tfvars files for commands" open>
          <summary>Var files</summary>
          <div id="tfvars-list" class="tfvars-list">No workspace selected</div>
        </details>
        <span id="snapshot-indicator" class="snapshot-indicator" title="Last pulled state snapshot">Snapshot: —</span>
        <span id="global-spinner" class="spinner hidden" aria-label="Running..." title="Terraform command running"></span>
      </div>
      <div class="actions">
        <button id="btn-init">Init</button>
        <button id="btn-plan">Plan</button>
        <button id="btn-refresh">Refresh</button>
        <button id="btn-apply">Apply</button>
      </div>
    </header>

    <main class="layout">
      <aside class="sidebar">
        <div class="panel-title row">
          <span>Resources</span>
          <div class="resources-controls">
            <input id="resources-search" class="resources-search" placeholder="Filter…" title="Filter modules and resources" />
          </div>
        </div>
        <div class="resources-controls">
          <button id="btn-res-collapse-all" title="Collapse all modules">Collapse all</button>
          <button id="btn-res-expand-all" title="Expand all modules">Expand all</button>
        </div>
        <ul id="resources-list" class="resources-list"></ul>
      </aside>
      <div id="resizer-sidebar" class="resizer resizer-vertical" title="Drag to resize sidebar"></div>
      <section class="content">
        <div class="tabs">
          <button id="tab-inspect" class="tab active">Inspect</button>
          <button id="tab-graph" class="tab">Graph</button>
        </div>
        <div class="split single">
          <div class="details">
            <div class="panel-title">Details</div>
            <pre id="resource-details" class="details-pre"><code class="language-terraform">Select a resource to view details</code></pre>
          </div>
        </div>

        <div id="graph-panel" class="graph-panel hidden">
          <div class="panel" style="height:100%">
            <div class="panel-title row">
              <span>Dependency Graph</span>
              <div class="graph-controls">
                <button id="btn-collapse-modules" title="Collapse all modules">Collapse all</button>
                <button id="btn-expand-modules" title="Expand all modules">Expand all</button>
                <button id="btn-relayout" title="Re-run layout">Re-layout</button>
              </div>
            </div>
            <div id="graph-area" class="graph-area">
              <div id="cy"></div>
            </div>
          </div>
        </div>

        <div id="resizer-logs" class="resizer resizer-horizontal" title="Drag to resize logs"></div>

        <div class="logs">
          <div class="panel-title row">
            <span>Logs</span>
            <div class="logs-controls">
              <select id="history-select" title="View past command logs"></select>
              <button id="btn-clear-history" class="icon-btn" title="Clear history">Clear</button>
              <button id="btn-toggle-logs" class="icon-btn" aria-expanded="true" title="Collapse/Expand logs">▾</button>
            </div>
          </div>
          <pre id="logs-pre" class="logs-pre"></pre>
        </div>
      </section>
    </main>

    <div id="context-menu" class="context-menu hidden">
      <div class="menu-item" data-action="import">Import existing (terraform import)</div>
      <div class="menu-item" data-action="rename">Rename (state mv)</div>
      <div class="menu-item danger" data-action="remove">Remove from state</div>
      <div class="menu-item" data-action="show">Show state (terraform state show)</div>
      <div class="menu-item" data-action="collapse-module">Collapse module</div>
      <div class="menu-item" data-action="expand-module">Expand module</div>
    </div>

    <!-- Rename Modal -->
    <div id="rename-modal" class="modal hidden">
      <div class="modal-dialog">
        <div class="modal-title">Rename resource (terraform state mv)</div>
        <input id="rename-input" placeholder="Destination address (e.g. aws_instance.web_new)" />
        <div class="modal-actions">
          <button id="btn-rename-cancel">Cancel</button>
          <button id="btn-rename-ok" class="primary">Rename</button>
        </div>
      </div>
    </div>

    <!-- Import Modal -->
    <div id="import-modal" class="modal hidden">
      <div class="modal-dialog">
        <div class="modal-title">Import existing resource (terraform import)</div>
        <input id="import-address" placeholder="Terraform address (e.g. aws_instance.web[0])" />
        <input id="import-id" placeholder="Import ID (provider-specific format)" />
        <div class="modal-actions">
          <button id="btn-import-cancel">Cancel</button>
          <button id="btn-import-ok" class="primary">Import</button>
        </div>
      </div>
    </div>

    <!-- Toast for current command -->
    <div id="toast" class="toast hidden" role="status" aria-live="polite"></div>

    <script src="https://unpkg.com/cytoscape@3.26.0/dist/cytoscape.min.js"></script>
    <script src="https://unpkg.com/elkjs/lib/elk.bundled.js"></script>
    <script src="https://unpkg.com/cytoscape-elk/cytoscape-elk.js"></script>
    <script src="https://unpkg.com/cytoscape-expand-collapse@4.1.0/cytoscape-expand-collapse.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/hcl.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/terraform.min.js"></script>
    <script>
      if (window.hljs) {
        window.hljs.configure({ languages: ['terraform','hcl'], ignoreUnescapedHTML: true });
        // In case any static code blocks exist before renderer.js runs
        document.querySelectorAll('pre code').forEach((el) => {
          try { window.hljs.highlightElement(el); } catch (e) {}
        });
      }
    </script>
    <script src="renderer.js"></script>
  </body>
  </html>



